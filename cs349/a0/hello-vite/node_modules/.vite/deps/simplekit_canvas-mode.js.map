{
  "version": 3,
  "sources": ["../../simplekit/src/events/events.ts", "../../simplekit/src/utility/misc.ts", "../../simplekit/src/events/translators.ts", "../../simplekit/src/windowing-system/windowing-system.ts", "../../simplekit/src/windowing-system/coalesce.ts", "../../simplekit/src/common.ts", "../../simplekit/package.json", "../../simplekit/src/canvas-mode.ts"],
  "sourcesContent": ["export class SKEvent {\n  constructor(\n    public type: string,\n    public timeStamp: number,\n    public source?: object\n  ) {}\n}\n\nexport class SKMouseEvent extends SKEvent {\n  constructor(\n    type: string,\n    timeStamp: number,\n    public x: number,\n    public y: number,\n    source?: object\n  ) {\n    super(type, timeStamp, source);\n  }\n}\n\nexport class SKKeyboardEvent extends SKEvent {\n  constructor(\n    type: string,\n    timeStamp: number,\n    public key: string | null = null,\n    source?: object\n  ) {\n    super(type, timeStamp, source);\n  }\n}\n\nexport class SKResizeEvent extends SKEvent {\n  constructor(\n    type: string,\n    timeStamp: number,\n    public width: number,\n    public height: number,\n    source?: object\n  ) {\n    super(type, timeStamp, source);\n  }\n}\n", "// Euclidean distance\nexport function distance(x1: number, y1: number, x2: number, y2: number) {\n  return Math.sqrt((x1 - x2) ** 2 + (y1 - y2) ** 2);\n}\n\n/**\n * returns a random number between a and b, or between 0 and a\n * @param a if b is undefined, a is the upper bound\n * @param b upper bound\n * @returns\n */\nexport function random(a: number, b?: number): number {\n  if (b != undefined) {\n    return a + Math.random() * (b - a);\n  } else {\n    return Math.random() * a;\n  }\n}\n", "import { FundamentalEvent } from \"../windowing-system\";\nimport { distance } from \"../utility\";\n\n// SimpleKit events\nimport {\n  SKEvent,\n  SKMouseEvent,\n  SKKeyboardEvent,\n  SKResizeEvent,\n} from \"./events\";\n\nexport type EventTranslator = {\n  update: (fe: FundamentalEvent) => SKEvent | undefined;\n};\n\nexport const fundamentalTranslator = {\n  update(fe: FundamentalEvent): SKEvent | undefined {\n    switch (fe.type) {\n      case \"mousedown\":\n      case \"mouseup\":\n      case \"mousemove\":\n        return new SKMouseEvent(\n          fe.type,\n          fe.timeStamp,\n          fe.x || 0,\n          fe.y || 0\n        );\n        break;\n      case \"keydown\":\n      case \"keyup\":\n        return new SKKeyboardEvent(fe.type, fe.timeStamp, fe.key);\n        break;\n      case \"resize\":\n        return new SKResizeEvent(\n          fe.type,\n          fe.timeStamp,\n          document.body.clientWidth,\n          document.body.clientHeight\n        );\n      // null events are used for translators to check time\n      // but, we don't want to actually emit them\n      case \"null\":\n        return;\n      default:\n        return new SKEvent(fe.type, fe.timeStamp);\n    }\n  },\n};\n\nexport const clickTranslator = {\n  state: \"IDLE\",\n  // parameters for transitions\n  movementThreshold: 10,\n  timeThreshold: 800, // milliseconds\n  // for tracking thresholds\n  startX: 0,\n  startY: 0,\n  startTime: 0,\n\n  // returns a click event if found\n  update(fe: FundamentalEvent): SKMouseEvent | undefined {\n    switch (this.state) {\n      case \"IDLE\":\n        if (fe.type == \"mousedown\") {\n          this.state = \"DOWN\";\n          this.startX = fe.x || 0;\n          this.startY = fe.y || 0;\n          this.startTime = fe.timeStamp;\n        }\n        break;\n\n      case \"DOWN\":\n        if (fe.timeStamp - this.startTime > this.timeThreshold) {\n          this.state = \"IDLE\";\n        } else if (\n          fe.x &&\n          fe.y &&\n          distance(fe.x, fe.y, this.startX, this.startY) >\n            this.movementThreshold\n        ) {\n          this.state = \"IDLE\";\n        } else if (fe.type == \"mouseup\") {\n          this.state = \"IDLE\";\n          return new SKMouseEvent(\n            \"click\",\n            fe.timeStamp,\n            fe.x || 0,\n            fe.y || 0\n          );\n        }\n        break;\n    }\n    return;\n  },\n};\n\nexport const dblclickTranslator = {\n  // internal click translator for dblclick\n  // note this is a copy of main clickTranslator object\n  internalClickTranslator: { ...clickTranslator },\n\n  state: \"IDLE\",\n  // parameters for transitions\n  timeThreshold: 500, // milliseconds\n  // for tracking thresholds\n  startTime: 0,\n\n  // returns a dblclick event if found\n  // needs a click event as well, the fe event is for time\n  update(fe: FundamentalEvent): SKMouseEvent | undefined {\n    // update internal clickTranslator\n    const e = this.internalClickTranslator.update(fe);\n\n    switch (this.state) {\n      case \"IDLE\":\n        if (e && e.type == \"click\") {\n          this.state = \"READY\";\n          this.startTime = e.timeStamp;\n        }\n        break;\n\n      case \"READY\":\n        if (fe.timeStamp - this.startTime > this.timeThreshold) {\n          this.state = \"IDLE\";\n        } else if (e && e.type == \"click\") {\n          this.state = \"IDLE\";\n          return new SKMouseEvent(\n            \"dblclick\",\n            fe.timeStamp,\n            fe.x || 0,\n            fe.y || 0\n          );\n        }\n        break;\n    }\n    return;\n  },\n};\n\nexport const dragTranslator = {\n  state: \"IDLE\",\n  // parameters for transitions\n  movementThreshold: 20,\n  // for tracking thresholds\n  startX: 0,\n  startY: 0,\n\n  // returns a drag event if found\n  update(fe: FundamentalEvent): SKMouseEvent | undefined {\n    switch (this.state) {\n      case \"IDLE\":\n        if (fe.type == \"mousedown\") {\n          this.state = \"DOWN\";\n          this.startX = fe.x || 0;\n          this.startY = fe.y || 0;\n        }\n        break;\n\n      case \"DOWN\":\n        if (fe.type == \"mouseup\") {\n          this.state = \"IDLE\";\n        } else if (\n          fe.type == \"mousemove\" &&\n          fe.x &&\n          fe.y &&\n          distance(fe.x, fe.y, this.startX, this.startY) >\n            this.movementThreshold\n        ) {\n          this.state = \"DRAG\";\n          return {\n            type: \"dragstart\",\n            timeStamp: fe.timeStamp,\n            x: fe.x,\n            y: fe.y,\n          } as SKMouseEvent;\n        }\n\n        break;\n\n      case \"DRAG\":\n        if (fe.type == \"mousemove\") {\n          return {\n            type: \"drag\",\n            timeStamp: fe.timeStamp,\n            x: fe.x,\n            y: fe.y,\n          } as SKMouseEvent;\n        } else if (fe.type == \"mouseup\") {\n          this.state = \"IDLE\";\n          return {\n            type: \"dragend\",\n            timeStamp: fe.timeStamp,\n            x: fe.x,\n            y: fe.y,\n          } as SKMouseEvent;\n        }\n\n        break;\n    }\n    return;\n  },\n};\n", "/**\n * Creates a simulated window system event loop\n * @module create-loop\n *\n */\n\nexport interface FundamentalEvent {\n  type:\n    | \"resize\"\n    | \"keydown\"\n    | \"keyup\"\n    | \"mousemove\"\n    | \"mousedown\"\n    | \"mouseup\"\n    | \"null\";\n  timeStamp: DOMHighResTimeStamp;\n  width?: number;\n  height?: number;\n  x?: number;\n  y?: number;\n  key?: string;\n}\n// TODO: FundamentalEvent type could better\n\nfunction createFundamentalEvent(\n  domEvent: Event\n): FundamentalEvent | undefined {\n  if (domEvent.type == \"resize\") {\n    return {\n      type: domEvent.type,\n      timeStamp: domEvent.timeStamp,\n      width: document.body.clientWidth,\n      height: document.body.clientHeight,\n    };\n  } else if (\n    domEvent.type == \"mouseup\" ||\n    domEvent.type == \"mousedown\" ||\n    domEvent.type == \"mousemove\"\n  ) {\n    const me = domEvent as MouseEvent;\n    return {\n      type: domEvent.type,\n      timeStamp: domEvent.timeStamp,\n      x: me.x,\n      y: me.y,\n    };\n  } else if (domEvent.type == \"keyup\" || domEvent.type == \"keydown\") {\n    const ke = domEvent as KeyboardEvent;\n    if (ke.repeat) return; // filter out key repeats\n    return {\n      type: domEvent.type,\n      timeStamp: domEvent.timeStamp,\n      key: ke.key,\n    };\n  } else {\n    console.warn(\n      `event ${domEvent.type} not supported as FundamentalEvent`\n    );\n    return;\n  }\n}\n\n/**\n * UI toolkit run loop callback\n * @eventQueue - queue of simulated fundamental events from system,\n * the toolkit run loop must pop events off this shared queue\n * @time - current time from the simulated windowing system\n */\nexport type RunLoopHandler = (\n  eventQueue: FundamentalEvent[],\n  time: DOMHighResTimeStamp\n) => void;\n\n/**\n * Creates a simulated windowing system event loop\n * @param {RunLoopHandler} runLoop - Callback function for UI toolkit run loop\n */\nexport function createWindowingSystem(runLoop: RunLoopHandler) {\n  // create the fundamental event queue\n  // the toolkit run loop must process these events and remove them from\n  // this shared queue\n  const eventQueue: FundamentalEvent[] = [];\n\n  // callback used for all events we want to add to the queue\n  function saveEvent(domEvent: Event) {\n    const fundamentalEvent = createFundamentalEvent(domEvent);\n    if (!fundamentalEvent) return;\n    eventQueue.push(fundamentalEvent);\n  }\n\n  // listen for \"fundamental events\" to simulate a low-level\n  // system event queue in a windowing system\n  window.addEventListener(\"mousedown\", saveEvent);\n  window.addEventListener(\"mouseup\", saveEvent);\n  window.addEventListener(\"mousemove\", saveEvent);\n  window.addEventListener(\"keydown\", saveEvent);\n  window.addEventListener(\"keyup\", saveEvent);\n  window.addEventListener(\"resize\", saveEvent);\n\n  // push a resize event to send on first frame of run loop\n  const initialResizeEvent = createFundamentalEvent(\n    new Event(\"resize\")\n  );\n  if (initialResizeEvent) eventQueue.push(initialResizeEvent);\n\n  // the simulated windowing system event loop\n  function loop(time: DOMHighResTimeStamp) {\n    skTime = time;\n    runLoop(eventQueue, time);\n    // schedule to run again\n    window.requestAnimationFrame(loop);\n  }\n  // start it\n  window.requestAnimationFrame(loop);\n}\n\n/**\n * Global time from windowing system\n * (when possible, use time from events or animation callback)\n */\nexport let skTime = 0;\n", "import { FundamentalEvent } from \".\";\n\n/**\n * Coalesces some fundamental events into a single event of the same type\n * @param events the array of events to coalesce (mutates the list)\n */\nexport function coalesceEvents(\n  events: FundamentalEvent[],\n  eventTypes = [\"mousemove\", \"resize\"]\n) {\n  const original = [...events];\n  events.length = 0;\n  original.forEach((e) => {\n    if (e.type in eventTypes) {\n      const i = events.findIndex((ee) => ee.type in eventTypes);\n      if (i > -1) {\n        events[i] = e;\n      } else {\n        events.push(e);\n      }\n    } else {\n      events.push(e);\n    }\n  });\n}\n//TODO this function implementation could be improved\n", "/**\n * Checks that HTML document hosting SimpleKit is setup correctly\n * @returns true if good, false otherwise\n */\nexport function checkHtml() {\n  let isGood = true;\n  // only one child in body\n  if (document.body.children.length !== 1) {\n    console.error(\n      `document body has ${document.body.children.length} children, must have 1`\n    );\n    isGood = false;\n  }\n  // the single child in body must be a script\n  if (!document.querySelector(\"body>script\")) {\n    console.error(\"document body must be a single <script> element\");\n    isGood = false;\n  }\n  // no style tags\n  if (document.querySelector(\"link[rel=stylesheet]\")) {\n    console.error(\"no <style> tags allowed\");\n    isGood = false;\n  }\n  // only script tag in head is vite/client\n  const scripts = document.querySelectorAll(\n    \"head>script\"\n  ) as NodeListOf<HTMLScriptElement>;\n  if (\n    scripts.length > 1 ||\n    !scripts[0]?.src.includes(\"vite/client\")\n  ) {\n    console.error(\n      \"only 1 <script> tag allowed in head for Vite client\"\n    );\n    isGood = false;\n  }\n  // no link tags other than a favicon link[rel=icon]\n  if (document.querySelector(\"link:not([rel=icon])\")) {\n    console.error(\n      `only <link> allowed is 1 <link rel=\"icon\" ...> in head`\n    );\n    isGood = false;\n  }\n  if (!isGood) {\n    console.log(\n      \"🛑 SimpleKit will not run with issues above. Fix HTML page hosting SimpleKit and/or disable browser plug-ins.\"\n    );\n  }\n  return isGood;\n}\n\nexport function setupCanvas(colour = \"whitesmoke\") {\n  // SimpleKit will draw everything in this single canvas\n  let canvas = document.createElement(\"canvas\");\n  document.body.appendChild(canvas);\n\n  // set some styles to make it easier to see the canvas\n  // canvas.style.setProperty(\"border\", \"1px solid blue\");\n  canvas.style.setProperty(\"background\", colour);\n\n  // set up canvas to fill window\n  // sizing method from https://codepen.io/tran2/pen/VYJWZw\n\n  // set style on html\n  document.documentElement.style.setProperty(\"width\", \"100%\");\n  document.documentElement.style.setProperty(\"height\", \"100%\");\n  document.documentElement.style.setProperty(\"margin\", \"0\");\n  document.documentElement.style.setProperty(\"padding\", \"0\");\n\n  // set style on body\n  document.body.style.setProperty(\"width\", \"100%\");\n  document.body.style.setProperty(\"height\", \"100%\");\n  document.body.style.setProperty(\"margin\", \"0\");\n  document.body.style.setProperty(\"padding\", \"0\");\n\n  canvas.style.setProperty(\"width\", \"100%\");\n  canvas.style.setProperty(\"height\", \"100%\");\n  canvas.style.setProperty(\"display\", \"block\");\n\n  // set to current window\n  canvas.width = document.body.clientWidth;\n  canvas.height = document.body.clientHeight;\n\n  // resize when window resizes\n  window.addEventListener(\"resize\", () => {\n    canvas.width = document.body.clientWidth;\n    canvas.height = document.body.clientHeight;\n  });\n\n  console.info(` created ${canvas.width} by ${canvas.height} canvas`);\n\n  return canvas;\n}\n", "{\n  \"name\": \"simplekit\",\n  \"version\": \"0.5.0\",\n  \"description\": \"A very simple user interface toolkit for teaching UI architecture.\",\n  \"author\": \"Daniel Vogel\",\n  \"license\": \"GPL-3.0-only\",\n  \"repository\": {\n    \"type\": \"git\",\n    \"url\": \"git+https://github.com/nonsequitoria/simplekit.git\"\n  },\n  \"bugs\": \"https://github.com/nonsequitoria/simplekit/issues\",\n  \"type\": \"module\",\n  \"exports\": {\n    \"./imperative-mode\": {\n      \"import\": \"./src/imperative-mode.ts\",\n      \"types\": \"./src/imperative-mode.ts\"\n    },\n    \"./canvas-mode\": {\n      \"import\": \"./src/canvas-mode.ts\",\n      \"types\": \"./src/canvas-mode.ts\"\n    },\n    \"./utility\": {\n      \"import\": \"./src/utility/index.ts\",\n      \"types\": \"./src/utility/index.ts\"\n    }\n  },\n  \"files\": [\n    \"src\"\n  ],\n  \"scripts\": {\n    \"start\": \"tsup --watch\",\n    \"build\": \"tsup\",\n    \"test\": \"jest\"\n  },\n  \"devDependencies\": {\n    \"@types/jest\": \"^29.5.11\",\n    \"jest\": \"^29.7.0\",\n    \"jest-environment-jsdom\": \"^29.7.0\",\n    \"ts-jest\": \"^29.1.1\",\n    \"ts-node\": \"^10.9.2\",\n    \"tsup\": \"^8.0.1\",\n    \"typescript\": \"^5.3.3\"\n  }\n}\n", "/**\n * SimpleKit Canvas Mode\n */\n\n// events\nexport * from \"./events\";\n// functions\nexport {\n  startSimpleKit,\n  setSKDrawCallback,\n  setSKEventListener,\n  setSKAnimationCallback,\n  addSKEventTranslator,\n};\nexport {\n  skTime, // global time from windowing system\n} from \"./windowing-system\";\nexport type {\n  FundamentalEvent, // needed for custom translators\n} from \"./windowing-system\";\n\n//  - - - - - - - - - - - - - - - - - - - - - - -\n\nimport {\n  FundamentalEvent,\n  createWindowingSystem,\n  coalesceEvents,\n} from \"./windowing-system\";\n\n// simple simulated UI Kit events\nimport { SKEvent } from \"./events\";\n\nimport {\n  EventTranslator,\n  fundamentalTranslator,\n  clickTranslator,\n  dblclickTranslator,\n  dragTranslator,\n} from \"./events\";\n\nimport { checkHtml, setupCanvas } from \"./common\";\n\n/**\n * The SimpleKit toolkit run loop (for canvas mode)\n * @param eventQueue fundamental events from simulated windowing system\n * @param time the windowing system frame time\n */\nfunction runLoop(eventQueue: FundamentalEvent[], time: number) {\n  // fundamental event queue coalescing\n  coalesceEvents(eventQueue);\n\n  // list of translated events to dispatch\n  let events: SKEvent[] = [];\n\n  // if no fundamental events, push a single \"null\" fundamental event\n  // this is because some translators trigger events based on time\n  // (like long press)\n  if (eventQueue.length == 0) {\n    eventQueue.push({\n      type: \"null\",\n      timeStamp: time,\n    } as FundamentalEvent);\n  }\n\n  // translate fundamental events to generate SKEvents\n  while (eventQueue.length > 0) {\n    const fundamentalEvent = eventQueue.shift();\n\n    if (!fundamentalEvent) continue;\n\n    translators.forEach((t) => {\n      const translatedEvent = t.update(fundamentalEvent);\n      if (translatedEvent) {\n        events.push(translatedEvent);\n      }\n    });\n  }\n\n  // global dispatch all events\n  if (eventListener) events.forEach((e) => eventListener(e));\n\n  // update animations\n  if (animateCallback) animateCallback(time);\n\n  // draw on canvas\n  if (drawCallback) drawCallback(gc);\n}\n\n// the single canvas rendering context\nlet gc: CanvasRenderingContext2D;\n\n// standard fundamental event translators\nconst translators: EventTranslator[] = [\n  fundamentalTranslator,\n  clickTranslator,\n  dblclickTranslator,\n  dragTranslator,\n];\n\n/**\n * Adds an fundamental event translator to the list of translators\n * @param translator the translator to add\n */\nfunction addSKEventTranslator(translator: EventTranslator) {\n  translators.push(translator);\n  console.log(\n    `added event translator, now ${translators.length} translators`\n  );\n}\n\n/**\n * Sets a global event listener\n * @param listener the event listener callback\n */\nfunction setSKEventListener(listener: EventListener) {\n  eventListener = listener;\n}\ntype EventListener = (e: SKEvent) => void;\nlet eventListener: EventListener;\n\n/**\n * Sets function to draw graphics each frame\n * @param draw the draw callback\n */\nfunction setSKDrawCallback(draw: DrawCallback) {\n  drawCallback = draw;\n}\ntype DrawCallback = (gc: CanvasRenderingContext2D) => void;\nlet drawCallback: DrawCallback;\n\n/**\n * Sets function to update animations each frame\n * @param animate the animation callback\n */\nfunction setSKAnimationCallback(animate: AnimationCallback) {\n  animateCallback = animate;\n}\ntype AnimationCallback = (time: number) => void;\nlet animateCallback: AnimationCallback;\n\nimport * as npmPackage from \"../package.json\";\n\n/**\n * Must be called once to start the SimpleKit run loop. It adds a\n * single canvas to the body for drawing and creates\n * the simulated windowing system to call the SimpleKit run loop\n * @returns { width, height } canvas size if successful, false otherwise\n */\nfunction startSimpleKit(): { width: number; height: number } | false {\n  console.info(\n    `🧰 SimpleKit v${npmPackage.version} *Canvas Mode* startup`\n  );\n\n  // check the HTML document hosting SimpleKit\n  if (!checkHtml()) return false;\n\n  // setup canvas\n  let canvas = setupCanvas();\n\n  // save graphics context to local module variable\n  const graphicsContext = canvas.getContext(\"2d\");\n  // this should never happen, but we need to check\n  if (!graphicsContext) {\n    console.error(\"Unable to get graphics context from canvas\");\n    return false;\n  }\n  gc = graphicsContext;\n\n  // start the toolkit run loop\n  createWindowingSystem(runLoop);\n\n  return { width: gc.canvas.width, height: gc.canvas.height };\n}\n"],
  "mappings": "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",
  "names": ["runLoop"]
}
